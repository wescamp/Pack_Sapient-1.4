#textdomain wesnoth-Pack_Sapient

#
# Multiplayer map for a Northerner RPG
#

[multiplayer]
    id=multiplayer_Northerners_RPG
    name= _ "4p - Northerners RPG"
    description= _ "A multiplayer map for the Northerners in an RPG-style scenario." + _"(Suggestion: fog of war, 1gpv, 70 turns, Use Map Settings)"
    map_data="{@campaigns/Pack_Sapient/maps/4p_Northerners_RPG.map}"
    turns=99
    experience_modifier=80%
    random_start_time=yes

    [music]
        name=northerners.ogg
    [/music]

    [variables]
        timber=0
    [/variables]

#define OBJ_ZEN_FLOWER X Y ID
    [item]
        x={X}
        y={Y}
        image=items/flower3.png
    [/item]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x={X}
            y={Y}
        [/filter]
        [object]
            id={ID}
            name= _ "Lotus Blossom"
            image=items/flower3.png
            duration=level
            description= _ "The Lotus heightens zen; ranged weapons are faster."
            cannot_use_message= _ "I hate flowers!"
            [filter]
                type=Orcish Assassin, Orcish Slayer, Orcish Archer, Orcish Crossbowman, Orcish Slurbow, Troll Rocklobber, Orcish Warlord
                x={X}
                y={Y}
                side=1,2,3,4
            [/filter]
            [then]
                [removeitem]
                    x,y={X},{Y}
                [/removeitem]
            [/then]
            [effect]
                apply_to=attack
                range=ranged
                increase_attacks=1
                [set_specials]
                    {WEAPON_SPECIAL_MARKSMAN}
                    mode=append
                [/set_specials]
            [/effect]
        [/object]
    [/event]
#enddef

#define OBJ_OLD_ARMOR X Y ID
    [item]
        x={X}
        y={Y}
        image=items/chest-plain-closed.png
    [/item]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x={X}
            y={Y}
        [/filter]
        [object]
            id={ID}
            name= _ "An old suit of Armor"
            image=items/armor.png
            duration=level
            description= _ "This armor is old, but it fits great! Ready for more beatings."
            cannot_use_message= _ "The armor looks nice, but it's too bulky for me to carry."
            [filter]
                type=Orcish Grunt, Orcish Warrior, Orcish Warlord, Troll Whelp, Troll Rocklobber, Troll Warrior, Troll
                x={X}
                y={Y}
                side=1,2,3,4
            [/filter]
            [then]
                [removeitem]
                    x,y={X},{Y}
                [/removeitem]
                [item]
                    x={X}
                    y={Y}
                    image=items/chest-plain-open.png
                [/item]
            [/then]
            [effect]
                apply_to=hitpoints
                increase_total=20
                increase=20
            [/effect]
            [effect]
                apply_to=resistance
                replace=false
                [resistance]
                    blade=-20
                    impact=-20
                    pierce=-20
                [/resistance]
            [/effect]
        [/object]
    [/event]
#enddef

#define OBJ_POTION_HOLIER X Y ID
    [item]
        x={X}
        y={Y}
        image=items/holy-water.png
    [/item]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x={X}
            y={Y}
        [/filter]
        [object]
            id={ID}
            name= _ "Holy Water"
            image=items/holy-water.png
            duration=level
            description= _ "This water will make melee weapons holy."
            cannot_use_message= _ "I am not suited to the use of this item! Let another take it."
            [filter]
                x={X}
                y={Y}
                side=1,2,3,4
            [/filter]
            [then]
                [removeitem]
                    x,y={X},{Y}
                [/removeitem]
            [/then]
            [effect]
                apply_to=attack
                range=melee
                set_type=arcane
                [set_specials]
                    {WEAPON_SPECIAL_MARKSMAN}
                    mode=append
                [/set_specials]
            [/effect]
        [/object]
    [/event]
#enddef

#define OBJ_LICH_CLAW X Y ID
    [item]
        x={X}
        y={Y}
        image=items/bones.png
    [/item]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x={X}
            y={Y}
        [/filter]
        [object]
            id={ID}
            name= _ "Skeletal Claw"
            image=attacks/touch-undead.png
            duration=forever
            description= _ "You find a lich's claw, and it hovers at your side obediently."
            cannot_use_message= _ "I ain't touching it."
            [filter]
                x,y={X},{Y}
                side=1,2,3,4
            [/filter]
            [then]
                [removeitem]
                    x,y={X},{Y}
                [/removeitem]
            [/then]
            [effect]
                apply_to=new_attack
                name= _ "lich's claw"
                icon=attacks/touch-undead.png
                type=cold
                range=seeker
                damage=8
                number=3
                [specials]
                    {WEAPON_SPECIAL_BERSERK}
                [/specials]
            [/effect]
            [effect]
                apply_to=new_animation
                [attack_anim]
                    [attack_filter]
                        name=_ "lich's claw"
                    [/attack_filter]
                    [frame]
                        begin=-200
                        end=-150
                        image="units/undead-necromancers/lich.png"
                    [/frame]
                    [frame]
                        begin=-150
                        end=100
                        image="units/undead-necromancers/lich-melee.png"
                        sound=wail-sml.wav
                    [/frame]
                    [frame]
                        begin=100
                        end=200
                        image="units/undead-necromancers/lich.png"
                    [/frame]
                [/attack_anim]
            [/effect]
        [/object]
    [/event]
#enddef

    # Scenery
    {OBJ_LICH_CLAW 31 12 clawid}
    {OBJ_POTION_HOLIER 7 23 holyid}
    {PLACE_IMAGE scenery/trapdoor_closed.png 45 22}
    {PLACE_IMAGE scenery/trapdoor_closed.png 12 43}
    {OBJ_OLD_ARMOR 15 13 chestid}
    {OBJ_ZEN_FLOWER 18 20 zenid}

    # Phases

    {DEFAULT_SCHEDULE}

    [time_area]
        x=1-50
        y=1-29

        {UNDERGROUND}
    [/time_area]

    # Six main sides.

    [side]
        side=1
        description= _ "Orcish Grunt"
        no_leader=yes
        team_name=Northerners
        canrecruit=1
        gold=25
        controller=human
        colour=blue
        fog=yes
        share_maps=yes
        share_view=yes
    [/side]

    [side]
        side=2
        no_leader=yes
        description= _ "Troll Whelp"
        team_name=Northerners
        canrecruit=1
        gold=25
        controller=human
        colour=purple
        fog=yes
        share_maps=yes
        share_view=yes
    [/side]

    [side]
        side=3
        no_leader=yes
        description= _ "Orcish Archer"
        team_name=Northerners
        canrecruit=1
        gold=25
        controller=human
        colour=black
        fog=yes
        share_maps=yes
        share_view=yes
    [/side]

    [side]
        side=4
        no_leader=yes
        description= _ "Orcish Assassin"
        team_name=Northerners
        canrecruit=1
        gold=25
        controller=human
        colour=brown
        fog=yes
        share_maps=yes
        share_view=yes
    [/side]

    [side]
        allow_player=no
        side=5
        no_leader=yes
        description="Computer1"
        team_name=Northerners
        canrecruit=1
        gold=25
        controller=ai
        colour=green
        fog=yes
        share_maps=no
        share_view=no
        income=-2
        village_gold=1
    [/side]

    [side]
        allow_player=no
        side=6
        no_leader=yes
        description="Computer2"
        team_name=Enemy
        canrecruit=1
        gold=25
        controller=ai
        colour=red
        fog=yes
        income=-2
        village_gold=1
        [ai]
            village_value=0
            leader_value=0
            aggression=1.0
        [/ai]
    [/side]

    [side]
        side=7
        no_leader=yes
        allow_player=no
        description="Computer3"
        team_name=Enemy
        canrecruit=1
        gold=25
        controller=ai
        colour=green
        fog=yes
        [ai]
            village_value=0
            leader_value=0
            aggression=1.0
        [/ai]
    [/side]
    [event]
        name=prestart
        #textdomain wesnoth-Pack_Sapient

#define LEADER TYPE X Y SIDE
    [unit]
        type={TYPE}
        side={SIDE}
        x,y={X},{Y}
        canrecruit=1
        [modifications]
            {TRAIT_LOYAL}
        [/modifications]
        description=Leader
        generate_description=yes
    [/unit]
#enddef

#define GUARD TYPE X Y SIDE
    [unit]
        type={TYPE}
        side={SIDE}
        x,y={X},{Y}
        ai_special=guardian
        [modifications]
            {TRAIT_LOYAL}
        [/modifications]
        generate_description=yes
    [/unit]
#enddef

#define SPAWN TYPE X Y SIDE
    [unit]
        type={TYPE}
        side={SIDE}
        x,y={X},{Y}
        [modifications]
            {TRAIT_LOYAL}
        [/modifications]
        generate_description=yes
    [/unit]
#enddef

        # Set up initial three units for each team.
        [unit]
            type="Thief"
            side=6
            x,y=41,47
            canrecruit=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            description=ThiefLeader
            generate_description=yes
        [/unit]
        {GUARD   "Drake Glider"   21 6 6}
        {GUARD   "Elvish Hero"   17 48 6}

        [unit]
            type="Orcish Sovereign"
            side=5
            x,y=46,46
            [modifications]
                [trait]
                    id=quick
                    name= _ "quick"
                    [effect]
                        apply_to=movement
                        increase=6
                    [/effect]
                [/trait]
                {TRAIT_INTELLIGENT}
            [/modifications]
            description=OrcLeader
            generate_description=yes
            overlays=units/orcish-sovereign.png
        [/unit]

        [unit]
            type="Orcish Grunt"
            side=1
            x,y=44,45
            canrecruit=1
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_QUICK}
                {OBJ_LEVELUP_HEAL}
            [/modifications]
            description=Warrior
            generate_description=yes
        [/unit]

        [unit]
            type="Troll Whelp"
            side=2
            x,y=47,45
            canrecruit=1
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
                {OBJ_LEVELUP_HEAL}
            [/modifications]
            description=Troll
            generate_description=yes
        [/unit]

        [unit]
            type="Orcish Archer"
            side=3
            x,y=43,44
            canrecruit=1
            [modifications]
                {TRAIT_QUICK}
                {TRAIT_RESILIENT}
                {OBJ_LEVELUP_HEAL}
            [/modifications]
            description=Archer
            generate_description=yes
        [/unit]

        [unit]
            type="Orcish Assassin"
            side=4
            x,y=45,44
            canrecruit=1
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
                {OBJ_LEVELUP_HEAL}
            [/modifications]
            description=Assassin
            generate_description=yes
        [/unit]

        {GUARD   "Goblin Spearman"   44 39 5}
        {GUARD   "Goblin Spearman"   48 41 5}

#define OBJECTIVES SIDE
    [objectives]
        side={SIDE}
        [objective]
            description= _ "Follow the thief!"
            condition=win
        [/objective]
        [objective]
            description= " "
            condition=win
        [/objective]
        [objective]
            description= _ "Investigate the area behind the waterfall."
            condition=win
        [/objective]
        [objective]
            description= _ "Death of all characters."
            condition=lose
        [/objective]
    [/objectives]
#enddef

        {OBJECTIVES 1}
        {OBJECTIVES 2}
        {OBJECTIVES 3}
        {OBJECTIVES 4}

#define CLEAR_RECRUIT SIDE
    [set_recruit]
        recruit=""
        side={SIDE}
    [/set_recruit]
#enddef

        # Force recruiting to match fixed sides.
        {CLEAR_RECRUIT 6}
        [allow_recruit]
            side=6
            type=Elvish Fighter,Elvish Archer,Elvish Shaman
        [/allow_recruit]

        {CLEAR_RECRUIT 5}
        {CLEAR_RECRUIT 1}
        {CLEAR_RECRUIT 2}
        {CLEAR_RECRUIT 3}
        {CLEAR_RECRUIT 4}
#define NORTHRPG_WATERFALL
    [item]
        x=46
        y=50
        image=projectiles/icemissile-n-6.png
    [/item]
    [item]
        x=46
        y=50
        image=projectiles/icemissile-n-5.png
    [/item]
    [item]
        x=46
        y=50
        image=projectiles/icemissile-n-4.png
    [/item]
    [item]
        x=46
        y=50
        image=halo/nature-halo1.png
    [/item]
#enddef
        {NORTHRPG_WATERFALL}
        [modify_turns]
            # since there is no way to check turns remaining
            # and people tend to set it too low
            # just make it 99 instead
            value=99
        [/modify_turns]
    [/event]

    # Backstory.
    [event]
        name=start
        [message]
            speaker=OrcLeader
            message= _ "My gold! My precious gold! Who has stolen it?"
        [/message]
        [message]
            speaker=ThiefLeader
            message= _ "Yoink! That was easy."
        [/message]
        [hide_unit]
            x,y=41,47
        [/hide_unit]
        [move_unit_fake]
            type=Thief
            x=41,42,43,44,45,46,46
            y=47,47,48,48,49,49,50
        [/move_unit_fake]
        [teleport]
            [filter]
                description=ThiefLeader
            [/filter]
            x=31
            y=12
        [/teleport]
        [item]
            x=46
            y=50
            image=units/human-outlaws/thief.png
        [/item]
        [message]
            speaker=OrcLeader
            message= _ "After him, you worthless louts! He went behind the waterfall.

...and don't come back without my gold, or I'll kill you all myself!"
        [/message]
        [removeitem]
            x,y=46,50
        [/removeitem]
        {NORTHRPG_WATERFALL}
        [hide_unit]
            x,y=46,46
        [/hide_unit]
        [move_unit_fake]
            type=Orcish Sovereign
            x=46,41
            y=46,47
        [/move_unit_fake]
        [teleport]
            [filter]
                description=OrcLeader
            [/filter]
            x=41
            y=47
        [/teleport]
        [unhide_unit]
        [/unhide_unit]
        [capture_village]
            side=5
            x=41
            y=47
        [/capture_village]
    [/event]

    # Entering the cave

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=46
            y=50
            level=1
        [/filter]
        [teleport]
            [filter]
                x=46
                y=50
            [/filter]
            x=6
            y=1
        [/teleport]
        [scroll_to_unit]
            x=6
            y=1
        [/scroll_to_unit]
    [/event]

#ifdef SAPIENT_DEBUG
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=46
            y=49
            description=OrcLeader
        [/filter]
        [teleport]
            [filter]
                description=OrcLeader
            [/filter]
            x=31
            y=12
        [/teleport]
    [/event]
#endif

#define TURN_SPAWN_UNDEAD TURN TYPE VILLAGE_X VILLAGE_Y
    [event]
        name=turn {TURN}
        first_time_only=yes
        {VARIABLE_OP generator_status to_variable "vil_{VILLAGE_X}_{VILLAGE_Y}"}
        [if]
            [variable]
                name=generator_status
                not_equals=2
            [/variable]
            [then]
                [unit]
                    type={TYPE}
                    side=6
                    x={VILLAGE_X}
                    y={VILLAGE_Y}
                    variation=wose
                    [modifications]
                        {TRAIT_UNDEAD}
                        {TRAIT_LOYAL}
                    [/modifications]
                [/unit]
            [/then]
        [/if]
    [/event]
#enddef

#define TURN_SPAWN TURN TYPE VILLAGE_X VILLAGE_Y
    [event]
        name=turn {TURN}
        first_time_only=yes
        {VARIABLE_OP generator_status to_variable "vil_{VILLAGE_X}_{VILLAGE_Y}"}
        [if]
            [variable]
                name=generator_status
                not_equals=2
            [/variable]
            [then]
                [unit]
                    type={TYPE}
                    side=6
                    x={VILLAGE_X}
                    y={VILLAGE_Y}
                    [modifications]
                        {TRAIT_LOYAL}
                    [/modifications]
                [/unit]
            [/then]
        [/if]
    [/event]
#enddef

    {TURN_SPAWN_UNDEAD 3 ("Vampire Bat") 11 15}
    {TURN_SPAWN_UNDEAD 5 ("Vampire Bat") 11 15}
    {TURN_SPAWN_UNDEAD 7 ("Vampire Bat") 11 15}
    {TURN_SPAWN_UNDEAD 9 ("Vampire Bat") 11 15}
    {TURN_SPAWN_UNDEAD 11 ("Vampire Bat") 11 15}

    {TURN_SPAWN 7 ("Dwarvish Fighter") 7 19}
    {TURN_SPAWN 11 ("Dwarvish Fighter") 7 19}
    {TURN_SPAWN 15 ("Dwarvish Fighter") 7 19}
    {TURN_SPAWN 19 ("Dwarvish Fighter") 7 19}
    {TURN_SPAWN 25 ("Dwarvish Fighter") 7 19}
    {TURN_SPAWN 28 ("Dwarvish Fighter") 7 19}

    {TURN_SPAWN_UNDEAD 19 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 19 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 19 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 19 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 24 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 24 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 24 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 24 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 29 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 29 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 29 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 29 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 34 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 34 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 34 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 34 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 38 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 38 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 38 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 38 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 39 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 39 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 39 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 39 ("Walking Corpse") 28 25}

    {TURN_SPAWN_UNDEAD 40 ("Walking Corpse") 25 22}
    {TURN_SPAWN_UNDEAD 40 ("Walking Corpse") 26 23}
    {TURN_SPAWN_UNDEAD 40 ("Walking Corpse") 28 23}
    {TURN_SPAWN_UNDEAD 40 ("Walking Corpse") 28 25}

    # Capture villages to stop spawn
    [event]
        name=capture
        first_time_only=no
        [filter]
            side=1,2,3,4
        [/filter]
        {VARIABLE_OP previous_status to_variable "vil_$x1|_$y1"}
        [if]
            [variable]
                name=previous_status
                not_equals=2
            [/variable]
            [then]
                {VARIABLE_OP coords format "vil_$x1|_$y1"}
                {VARIABLE $coords 2}
                {CLEAR_VARIABLE coords}
                [message]
                    speaker=unit
                    message= _ "Village secured."
                [/message]
            [/then]
        [/if]
        {CLEAR_VARIABLE previous_status}
    [/event]

    # necromancer repairs villages to spawn
    [event]
        name=capture
        first_time_only=no
        [filter]
            side=6
            description=SorcLeader
        [/filter]
        {VARIABLE_OP previous_status to_variable "vil_$x1|_$y1"}
        [if]
            [variable]
                name=previous_status
                equals=2
            [/variable]
            [then]
                {VARIABLE_OP coords format "vil_$x1|_$y1"}
                {VARIABLE $coords 1}
                {CLEAR_VARIABLE coords}
                [message]
                    speaker=unit
                    message= _ "You can't stop me! Never!"
                [/message]
            [/then]
        [/if]
        {CLEAR_VARIABLE previous_status}
    [/event]

    [event]
        name=turn 2
        first_time_only=yes
        [store_unit]
            [filter]
                description=ThiefLeader
            [/filter]
            variable=leaderstore
            kill=yes
        [/store_unit]
        [unit]
            type="Necromancer"
            side=6
            x,y=30,22
            canrecruit=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            description=SorcLeader
            generate_description=yes
        [/unit]
        {CLEAR_VARIABLE leaderstore}
        {CLEAR_RECRUIT 6}
        [music]
            name=underground.ogg
        [/music]
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            description=SorcLeader
        [/filter]
        [store_unit]
            [filter]
                description=SorcLeader
            [/filter]
            variable=leaderstore
            kill=yes
        [/store_unit]
        [unit]
            type="Elvish Captain"
            side=6
            x,y=18,45
            canrecruit=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            description=ElfLeader
            generate_description=yes
        [/unit]
        {CLEAR_VARIABLE leaderstore}
        [allow_recruit]
            side=6
            type=Elvish Fighter,Elvish Archer,Elvish Shaman
        [/allow_recruit]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=45
            y=22
        [/filter]
        [if]
            [variable]
                name=timber
                equals=2
            [/variable]
            [then]
                [teleport]
                    [filter]
                        x,y=45,22
                    [/filter]
                    x=12
                    y=43
                [/teleport]
                [scroll_to_unit]
                    x=12
                    y=43
                [/scroll_to_unit]
                [music]
                    name=elf-land.ogg
                [/music]
            [/then]
            [else]
                [if]
                    [variable]
                        name=timber
                        equals=1
                    [/variable]
                    [then]
                        [message]
                            speaker=unit
                            message= _ "There's a secret passage here."
                        [/message]
                        [removeitem]
                            x,y=45,22
                        [/removeitem]
                        [removeitem]
                            x,y=12,43
                        [/removeitem]
                        [item]
                            x=45
                            y=22
                            image=items/trapdoor-open.png
                        [/item]
                        [item]
                            x=12
                            y=43
                            image=items/trapdoor-open.png
                        [/item]
                        {VARIABLE timber 2}
                    [/then]
                    [else]
                        [message]
                            speaker=unit
                            message= _ "This slab won't budge. Maybe if I had a large enough lever."
                        [/message]
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]

    [event]
        [allow_undo]
        [/allow_undo]
        name=moveto
        first_time_only=no
        [if]
            [variable]
                name=timber
                equals=2
            [/variable]
            [have_unit]
                description=SorcLeader
            [/have_unit]
            [then]
                [if]
                    [have_unit]
                        x=45
                        y=22
                    [/have_unit]
                    [else]
                        [teleport]
                            [filter]
                                description=SorcLeader
                            [/filter]
                            x=45
                            y=22
                        [/teleport]
                    [/else]
                [/if]
            [/then]
            [else]
                [allow_undo]
                [/allow_undo]
            [/else]
        [/if]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=33
            y=15
        [/filter]
        [if]
            [variable]
                name=timber
                equals=0
            [/variable]
            [then]
                [message]
                    image=items/pine1.png
                    speaker=narrator
                    message=_ "The great tree seems to be decaying. What will you do?"
                    [option]
                        message=_ "Pull off a branch"
                        [command]
                            {VARIABLE timber 1}
                            [teleport]
                                [filter]
                                    x,y=33,15
                                [/filter]
                                x=33
                                y=16
                            [/teleport]
                            [terrain]
                                x=33
                                y=15
                                letter=Uu^Ii
                            [/terrain]
                            [unit]
                                type="Ancient Wose"
                                side=6
                                x,y=33,15
                                [modifications]
                                    {TRAIT_LOYAL}
                                    {TRAIL_INTELLIGENT}
                                [/modifications]
                                description=GreatTree
                                generate_description=yes
                            [/unit]
                        [/command]
                    [/option]
                    [option]
                        message= _ "Leave it alone"
                        [command]
                        [/command]
                    [/option]
                    image=wesnoth-icon.png
                [/message]
            [/then]
        [/if]
    [/event]

    [event]
        name=die
        first_time_only=yes
        [filter]
            description=OrcLeader
        [/filter]
        [message]
            speaker=second_unit
            message= _ "At last, I claim my rightful place: as leader of this clan."
            sound="victory.ogg"
        [/message]
    [/event]

    [event]
        name=die
        first_time_only=yes
        [filter]
            description=ElfLeader
        [/filter]
        {MODIFY_UNIT side=5 side 7}
        {MODIFY_UNIT description=OrcLeader canrecruit 1}
        {CLEAR_RECRUIT 7}
        [remove_shroud]
            side=1,2,3,4
            x=12-14
            y=48-50
        [/remove_shroud]
        [if]
            [not]
                [have_unit]
                    x,y=13,49
                [/have_unit]
            [/not]
            [then]
                [unit]
                    type=Pirate Galleon
                    x,y=13,49
                    side=1
                    facing=left
                [/unit]
            [/then]
        [/if]
        [item]
            x=13
            y=49
            image=units/transport/pirate-galleon.png~TC(1,magenta)
            facing=left
        [/item]
        [message]
            speaker=second_unit
            message= _ "Look, a ship! Time to get out of here."
        [/message]
        {VARIABLE ship 1}
        [scroll_to_unit]
            x,y=13,49
        [/scroll_to_unit]
        [kill]
            animate=no
            type=Pirate Galleon
        [/kill]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=13
            y=49
        [/filter]
        [if]
            [variable]
                name=ship
                equals=1
            [/variable]
            [then]
                [item]
                    x=38
                    y=37
                    image=units/transport/pirate-galleon.png~TC(1,magenta)
                [/item]
                [teleport]
                    [filter]
                        side=3
                    [/filter]
                    x=39
                    y=38
                [/teleport]
                [teleport]
                    [filter]
                        side=1
                    [/filter]
                    x=39
                    y=39
                [/teleport]
                [teleport]
                    [filter]
                        side=2
                    [/filter]
                    x=38
                    y=38
                [/teleport]
                [teleport]
                    [filter]
                        side=4
                    [/filter]
                    x=38
                    y=39
                [/teleport]
                [removeitem]
                    x=13
                    y=49
                [/removeitem]
                [scroll_to]
                    x=39
                    y=38
                [/scroll_to]
                [allow_recruit]
                    side=7
                    type=Goblin Pillager, Goblin Impaler
                [/allow_recruit]
                [kill]
                    animate=no
                    type=Goblin Spearman
                [/kill]
                {GUARD   "Goblin Impaler"   44 39 5}
                {GUARD   "Goblin Impaler"   48 41 7}
                {GUARD   "Goblin Pillager"   39 47 7}
                {GUARD   "Goblin Pillager"   49 48 7}
                {GUARD   "Goblin Pillager"   48 48 7}
                {GUARD   "Goblin Pillager"   42 46 7}
                [store_gold]
                    side=1
                    variable=stolen_gold
                [/store_gold]
                [modify_side]
                    side=7
                    gold=$stolen_gold
                [/modify_side]
                [music]
                    name=northerners.ogg
                [/music]
            [/then]
        [/if]
    [/event]

    [event]
        name=attack
        first_time_only=yes
        [filter_second]
            type=Walking Corpse
        [/filter_second]
        [music]
            name=frantic.ogg
            play_once=yes
            immediate=yes
        [/music]
    [/event]

    [event]
        name=attack
        first_time_only=yes
        [filter]
            type=Vampire Bat
        [/filter]
        [music]
            name=frantic.ogg
            play_once=yes
            immediate=yes
        [/music]
    [/event]

    [event]
        name=attack
        first_time_only=yes
        [filter]
            type=Elvish Captain,Elvish Fighter,Elvish Archer,Elvish Hero,Elvish Shaman
        [/filter]
        [message]
            speaker=unit
            message= _ "Ah! So you must be the ones who took our sacred tree.

Since its loss, my people have lost our way and become pirates."
        [/message]
        [message]
            speaker=second_unit
            message= _ "I didn't take your sacred tree, but maybe I did kill it. Heh.

You're next, foolish elf."
        [/message]
    [/event]

    [event]
        name=attack
        first_time_only=yes
        [filter]
            side=7
        [/filter]
        [message]
            speaker=unit
            message= _ "Pirates! You won't take this land without a fight"
        [/message]
        [message]
            speaker=second_unit
            message= _ "Look! Don't you remember me?

We went into the caves to find the thief, but he must have died inside. We never found him."
        [/message]
        [message]
            speaker=unit
            message= _ "You... look familiar. But, no! It's impossible."
        [/message]
        {MODIFY_UNIT side=5 side 7}
    [/event]

    [event]
        name=attack
        first_time_only=no
        [filter]
#define NORTHRPG_AMLA_TYPES
    type=Troll Rocklobber,Orcish Slayer,Troll Warrior,Orcish Slurbow,Orcish Warlord
    [not]
        role=amla_heal
    [/not]
#enddef
            {NORTHRPG_AMLA_TYPES}
        [/filter]
#define NORTHRPG_AMLA_ADD FILTER
    [store_unit]
        [filter]
            {FILTER}
        [/filter]
        variable=heal_store
        kill=yes
    [/store_unit]
    [set_variable]
        name=heal_store.role
        value=amla_heal
    [/set_variable]
    [set_variable]
        name=heal_store.advancement[0].effect[2].apply_to
        value=hitpoints
    [/set_variable]
    [set_variable]
        name=heal_store.advancement[0].effect[2].increase_total
        value=0%
    [/set_variable]
    [set_variable]
        name=heal_store.advancement[0].effect[2].heal_full
        value=yes
    [/set_variable]
    [unstore_unit]
        variable=heal_store
    [/unstore_unit]
#enddef
        {NORTHRPG_AMLA_ADD x,y=$x1,$y1}
    [/event]

    [event]
        name=attack
        first_time_only=no
        [filter_second]
            {NORTHRPG_AMLA_TYPES}
        [/filter_second]
        {NORTHRPG_AMLA_ADD x,y=$x2,$y2}
    [/event]
[/multiplayer]
